<form [formGroup]="tournamentForm" (ngSubmit)="onSubmit()" class="space-y-6">
  <div>
    <label class="block text-sm font-medium mb-2">Tournament Banner</label>

    <div
      class="relative border-2 border-dashed rounded-xl flex items-center justify-center cursor-pointer transition h-48"
      (click)="fileInput.click()"
      (dragover)="onDragOver($event)"
      (dragleave)="onDragLeave($event)"
      (drop)="onDrop($event)"
    >
      <input
        type="file"
        #fileInput
        accept="image/*"
        class="hidden"
        (change)="onBannerChange($event)"
      />

      @if (!bannerPreview()) {
      <div class="text-center px-4">
        <p class="text-sm text-muted-foreground">
          Drag & drop your banner here, or
          <span class="font-medium underline">click to upload</span>
        </p>
        <p class="text-xs text-muted-foreground mt-1">
          Recommended: 1200x400px
        </p>
      </div>
      } @if (bannerPreview()) {
      <img
        [src]="bannerPreview()"
        alt="Banner Preview"
        class="absolute inset-0 w-full h-full object-cover rounded-xl"
      />
      }
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div class="md:col-span-2">
      <label for="name" class="block text-sm font-medium mb-2">
        Tournament Name <span class="required">*</span>
      </label>
      <input
        type="text"
        id="name"
        formControlName="name"
        placeholder="Enter tournament name"
        class="input-field"
        [ngClass]="{
          'border-destructive':
            isSubmitted() && tournamentForm.get('name')?.invalid
        }"
      />
      @if (isSubmitted() && tournamentForm.get('name')?.invalid) {
      <div class="text-sm error mt-1">
        Tournament name is required (min 3 characters)
      </div>
      }
    </div>

    <div class="md:col-span-2">
      <label for="description" class="block text-sm font-medium mb-2">
        Tournament Description <span class="required">*</span>
      </label>
      <textarea
        id="description"
        formControlName="description"
        placeholder="Describe your tournament"
        class="input-field h-32 resize-none"
        [ngClass]="{
          'border-destructive':
            isSubmitted() && tournamentForm.get('description')?.invalid
        }"
      ></textarea>
      @if (isSubmitted() && tournamentForm.get('description')?.invalid) {
      <div class="text-sm error mt-1">
        Description must be at least 10 characters
      </div>
      }
    </div>

    <div>
      <label for="location" class="block text-sm font-medium mb-2">
        Location <span class="required">*</span>
      </label>
      <input
        type="text"
        id="location"
        formControlName="location"
        placeholder="Tournament location"
        class="input-field"
        [ngClass]="{
          'border-destructive':
            isSubmitted() && tournamentForm.get('location')?.invalid
        }"
      />
      @if (isSubmitted() && tournamentForm.get('location')?.invalid) {
      <div class="text-sm error mt-1">Location is required</div>
      }
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <!-- Registration Deadline -->
    <div>
      <label for="registrationDeadline" class="block text-sm font-medium mb-2">
        Registration Deadline <span class="required">*</span>
      </label>
      <input
        type="datetime-local"
        id="registrationDeadline"
        formControlName="registrationDeadline"
        class="input-field"
      />
      @if (tournamentForm.errors?.['deadlineInvalid']) {
      <div class="text-sm error mt-1">
        Deadline must be before tournament start
      </div>
      }
    </div>

    <!-- Start Date -->
    <div>
      <label for="startDate" class="block text-sm font-medium mb-2">
        Start Date <span class="required">*</span>
      </label>
      <input
        type="datetime-local"
        id="startDate"
        formControlName="startDate"
        class="input-field"
      />
      @if (isSubmitted() && tournamentForm.get('startDate')?.invalid) {
      <div class="text-sm error mt-1">Start date is required</div>
      }
    </div>

    <!-- End Date -->
    <div>
      <label for="endDate" class="block text-sm font-medium mb-2">
        End Date <span class="required">*</span>
      </label>
      <input
        type="datetime-local"
        id="endDate"
        formControlName="endDate"
        class="input-field"
      />
      @if (isSubmitted() && tournamentForm.get('endDate')?.invalid) {
      <div class="text-sm error mt-1">End date is required</div>
      } @if (tournamentForm.errors?.['dateRange']) {
      <div class="text-sm error mt-1">End date must be after start date</div>
      }
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <div>
      <label for="maxTeams" class="block text-sm font-medium mb-2">
        Maximum Teams <span class="required">*</span>
      </label>
      <select id="maxTeams" formControlName="maxTeams" class="form-select">
        <option value="4">4 Teams</option>
        <option value="8">8 Teams</option>
        <option value="16">16 Teams</option>
        <option value="32">32 Teams</option>
        <option value="64">64 Teams</option>
      </select>
    </div>

    <div>
      <label for="entryFee" class="block text-sm font-medium mb-2"
        >Entry Fee</label
      >
      <input
        type="number"
        id="entryFee"
        formControlName="entryFee"
        class="input-field"
      />
    </div>

    <div>
      <label for="prize" class="block text-sm font-medium mb-2"
        >Prize Pool</label
      >
      <input
        type="number"
        id="prize"
        formControlName="prize"
        class="input-field"
      />
    </div>
  </div>

  <div>
    <label for="contactEmail" class="block text-sm font-medium mb-2">
      Contact Email <span class="required">*</span>
    </label>
    <input
      type="email"
      id="contactEmail"
      formControlName="contactEmail"
      placeholder="contact@example.com"
      class="input-field"
    />
    @if (isSubmitted() &&
    tournamentForm.get('contactEmail')?.errors?.['required']) {
    <div class="text-sm error mt-1">Contact email is required</div>
    } @if (isSubmitted() &&
    tournamentForm.get('contactEmail')?.errors?.['email']) {
    <div class="text-sm error mt-1">Please enter a valid email</div>
    }
  </div>

  <div class="flex gap-4">
    @if (isEditMode()) {
    <button
      type="button"
      (click)="onCancel()"
      class="btn btn-outline flex-1"
      [disabled]="isSubmitting()"
    >
      Cancel
    </button>
    }
    <button
      type="submit"
      [disabled]="isSubmitting()"
      class="btn btn-primary"
      [class.w-full]="!isEditMode()"
      [class.flex-1]="isEditMode()"
    >
      <div class="flex items-center justify-center gap-2">
        @if (isSubmitting()) {
        <lucide-angular
          [img]="icons.Loader2"
          size="16"
          class="animate-spin"
        ></lucide-angular>
        }
        {{ submitButtonText() }}
      </div>
    </button>
  </div>
</form>
