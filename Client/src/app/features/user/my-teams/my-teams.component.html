<app-user-layout>
  <div class="my-teams-container">
    <div class="header">
      <h1>My Teams</h1>
      <p class="subtitle">Teams you're part of or managing</p>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading()" class="loading">
      <div class="spinner"></div>
      <p>Loading your teams...</p>
    </div>

    <!-- Empty State -->
    <div *ngIf="!isLoading() && myTeams().length === 0" class="empty-state">
      <div class="empty-icon">👥</div>
      <h3>No teams yet</h3>
      <p>
        You're not part of any teams yet. Join a team or create your own to get
        started!
      </p>
      <div class="action-buttons">
        <button class="btn-primary" (click)="createTeam()">Create Team</button>
        <button class="btn-outline" (click)="findTeams()">Find Teams</button>
      </div>
    </div>

    <!-- Teams Grid -->
    <div *ngIf="!isLoading() && myTeams().length > 0" class="teams-grid">
      <div
        *ngFor="let team of myTeams()"
        class="team-card"
        [class.active]="team.status === 'active'"
        [class.pending]="team.status === 'pending'"
        [class.inactive]="team.status === 'inactive'"
      >
        <div class="team-header">
          <div class="team-logo">
            <img
              *ngIf="team.logoUrl"
              [src]="team.logoUrl"
              [alt]="team.name + ' logo'"
              class="logo-image"
            />
            <div *ngIf="!team.logoUrl" class="logo-placeholder">
              {{ getTeamInitials(team.name) }}
            </div>
          </div>
          <div class="team-info">
            <h3>{{ team.name }}</h3>
            <p class="manager">Manager: {{ team.manager }}</p>
            <div class="badges">
              <span class="role-badge" [attr.data-role]="team.role">
                {{ team.role }}
              </span>
              <span class="status-badge" [attr.data-status]="team.status">
                {{ team.status }}
              </span>
            </div>
          </div>
        </div>

        <div class="team-stats" *ngIf="team.status === 'active'">
          <div class="stat-item">
            <span class="stat-label">Players</span>
            <span class="stat-value">{{ team.numberOfPlayers }}</span>
          </div>
          <div class="stat-item" *ngIf="team.wins !== undefined">
            <span class="stat-label">Wins</span>
            <span class="stat-value wins">{{ team.wins }}</span>
          </div>
          <div class="stat-item" *ngIf="team.losses !== undefined">
            <span class="stat-label">Losses</span>
            <span class="stat-value losses">{{ team.losses }}</span>
          </div>
          <div class="stat-item" *ngIf="team.rank">
            <span class="stat-label">Rank</span>
            <span class="stat-value rank">#{{ team.rank }}</span>
          </div>
        </div>

        <div class="team-tournament" *ngIf="team.currentTournament">
          <div class="tournament-info">
            <span class="tournament-label">Current Tournament:</span>
            <span class="tournament-name">{{ team.tournamentName }}</span>
          </div>
        </div>

        <div class="team-meta">
          <div class="meta-item">
            <span class="meta-label">Joined:</span>
            <span class="meta-value">{{
              team.joinedDate | date : "MMM d, y"
            }}</span>
          </div>
          <div class="meta-item">
            <span class="meta-label">Created:</span>
            <span class="meta-value">{{
              team.createdAt | date : "MMM d, y"
            }}</span>
          </div>
        </div>

        <div class="team-actions">
          <button class="btn-outline" (click)="viewTeam(team.id)">
            View Details
          </button>
          <button
            *ngIf="team.role === 'captain'"
            class="btn-primary"
            (click)="manageTeam(team.id)"
          >
            Manage Team
          </button>
          <button
            *ngIf="team.status === 'pending'"
            class="btn-secondary"
            (click)="leaveTeam(team.id)"
          >
            Leave Team
          </button>
        </div>
      </div>
    </div>

    <!-- Quick Actions & Stats -->
    <div *ngIf="!isLoading() && myTeams().length > 0" class="bottom-section">
      <!-- Quick Stats -->
      <div class="quick-stats">
        <div class="stat-card">
          <div class="stat-number">{{ activeTeams().length }}</div>
          <div class="stat-label">Active Teams</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">{{ teamsAsLeader().length }}</div>
          <div class="stat-label">Teams Led</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">{{ totalWins() }}</div>
          <div class="stat-label">Total Wins</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">{{ winRate() }}%</div>
          <div class="stat-label">Win Rate</div>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="quick-actions">
        <h3>Quick Actions</h3>
        <div class="action-grid">
          <button class="action-btn" (click)="createTeam()">
            <span class="action-icon">➕</span>
            <span class="action-text">Create New Team</span>
          </button>
          <button class="action-btn" (click)="findTeams()">
            <span class="action-icon">🔍</span>
            <span class="action-text">Find Teams</span>
          </button>
          <button class="action-btn" (click)="viewInvitations()">
            <span class="action-icon">📧</span>
            <span class="action-text">Team Invitations</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</app-user-layout>
