<div class="mb-6">
  <div
    class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-4"
  >
    <h2 class="text-xl font-semibold">Registered Teams</h2>
    <div class="flex items-center gap-3">
      <div class="text-sm">
        {{ filteredTeams().length || 0 }} of
        {{ tournament()?.maxTeams || 0 }} teams
      </div>
    </div>
  </div>

  <div class="relative mb-4">
    <div class="absolute inset-y-0 left-0 pl-3 flex items-center">
      <lucide-angular [img]="icons.Search" size="20" class=""></lucide-angular>
    </div>
    <input
      type="text"
      placeholder="Search teams..."
      [(ngModel)]="searchTerm"
      (ngModelChange)="onSearchChange()"
      class="input-field pl-10 w-full"
    />
    @if (searchTerm()) {
    <button
      (click)="clearSearch()"
      class="absolute inset-y-0 right-0 pr-3 flex items-center"
    >
      <lucide-angular [img]="icons.X" size="16"></lucide-angular>
    </button>
    }
  </div>

  @if (loading()) {
  <div class="space-y-4">
    <div class="text-center py-8">
      <div
        class="inline-flex items-center justify-center w-12 h-12 rounded-full mb-4"
      >
        <lucide-angular
          [img]="icons.Loader2"
          size="20"
          class="animate-spin"
        ></lucide-angular>
      </div>
      <p class="">Loading teams...</p>
    </div>
  </div>
  } @else {
  <div
    class="flex flex-wrap justify-center sm:justify-start sm:items-center gap-4"
  >
    @for (team of filteredTeams(); track team.id) {
    <div>
      <app-team-card
        [team]="team"
        [showActions]="true"
        (edit)="onEditTeam($event)"
        (delete)="onDeleteTeam(team.id)"
      ></app-team-card>
    </div>
    } @if (tournament() && filteredTeams().length < tournament()!.maxTeams &&
    filteredTeams().length !== 0) {
    <div
      class="border-2 border-dashed border-border rounded-lg flex flex-col items-center justify-center px-6 py-3 cursor-pointer"
      (click)="onAddTeam()"
    >
      <div class="w-12 h-12 rounded-full flex items-center justify-center mb-4">
        <lucide-angular
          [img]="icons.UserPlus"
          size="20"
          class=""
        ></lucide-angular>
      </div>
      <h3 class="font-medium mb-1">Add New Team</h3>
      <p class="text-xs text-center">
        Click to register a team for this tournament
      </p>
    </div>
    }
  </div>

  @if (filteredTeams().length === 0 && searchTerm()) {
  <div
    class="border-2 border-dashed border-border rounded-lg flex flex-col items-center justify-center p-8 text-center"
  >
    <div
      class="w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center"
    >
      <lucide-angular [img]="icons.Search" size="24" class=""></lucide-angular>
    </div>
    <h3 class="text-lg font-semibold mb-2">No teams found</h3>
    <p class="mb-4">No teams match your search criteria "{{ searchTerm() }}"</p>
    <button
      (click)="clearSearch()"
      class="inline-flex items-center gap-2 px-4 py-2 text-sm border border-border rounded-md transition-colors"
    >
      <lucide-angular [img]="icons.X" size="16"></lucide-angular>
      Clear search
    </button>
  </div>
  } @else if (filteredTeams().length === 0) {
  <div
    class="border-2 border-dashed border-border rounded-lg flex flex-col items-center justify-center p-12 text-center"
  >
    <div
      class="w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center"
    >
      <lucide-angular [img]="icons.Users" size="24" class=""></lucide-angular>
    </div>
    <h3 class="text-lg font-semibold mb-2">No teams registered yet</h3>
    <p class="mb-6 max-w-sm">
      Add teams to get started with your tournament. You can register up to
      {{ tournament()?.maxTeams }} teams.
    </p>
    <button
      (click)="onAddTeam()"
      class="inline-flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors"
    >
      <lucide-angular [img]="icons.UserPlus" size="16"></lucide-angular>
      Add First Team
    </button>
  </div>
  } }
</div>
