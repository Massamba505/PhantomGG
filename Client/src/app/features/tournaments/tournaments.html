<app-dashboard-layout>
  <div
    class="flex flex-col md:flex-row md:items-center md:justify-between border-b border-border pb-6 gap-4"
  >
    <div
      class="flex flex-col md:flex-row items-stretch md:items-center gap-4 w-full"
    >
      <div class="relative flex-1 max-w-2xl">
        <div
          class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
        >
          <lucide-angular [img]="icons.Search" size="20"></lucide-angular>
        </div>
        <input
          type="text"
          placeholder="Search tournaments..."
          [(ngModel)]="searchTerm"
          (ngModelChange)="filterTournaments()"
          class="input-field pl-10 w-full"
        />
      </div>

      <div class="relative flex-1 max-w-md">
        <div
          class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"
        >
          <lucide-angular [img]="icons.Funnel" size="20"></lucide-angular>
        </div>
        <select
          [(ngModel)]="filterStatus"
          (ngModelChange)="filterTournaments()"
          class="form-select appearance-none w-full pr-10"
        >
          <option value="all">All Statuses</option>
          <option value="draft">Draft</option>
          <option value="active">Active</option>
          <option value="completed">Completed</option>
        </select>
      </div>
    </div>

    <div class="flex justify-end">
      <button
        (click)="createNewTournament()"
        class="btn btn-primary flex items-center gap-2 whitespace-nowrap"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="lucide lucide-plus"
        >
          <path d="M12 5v14M5 12h14" />
        </svg>
        <span>New Tournament</span>
      </button>
    </div>
  </div>

  <section class="p-6">
    <div class="mb-4 flex justify-between items-center">
      <p>
        Showing
        <span>{{ filteredTournaments.length }}</span>
        tournaments
      </p>
      <div class="flex gap-2">
        <button
          (click)="switchLayout(false)"
          title="Stretch Horizontal"
          class="cursor-pointer"
        >
          <lucide-angular
            [img]="icons.StretchHorizontal"
            size="20"
          ></lucide-angular>
        </button>
        <button
          (click)="switchLayout(true)"
          title="Layout Grid"
          class="cursor-pointer"
        >
          <lucide-angular [img]="icons.LayoutGrid" size="20"></lucide-angular>
        </button>
      </div>
    </div>

    <div
      *ngIf="filteredTournaments.length > 0"
      [class]="
        gridLayout()
          ? 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6'
          : 'flex flex-col gap-3'
      "
    >
      <div *ngFor="let tournament of filteredTournaments">
        <app-tournament-card
          [tournament]="tournament"
          (delete)="handleDeleteTournament($event)"
          (edit)="handleEditTournament($event)"
          (view)="handleViewTournament($event)"
        ></app-tournament-card>
      </div>
    </div>

    <div *ngIf="filteredTournaments.length === 0" class="text-center py-16">
      <div
        class="bg-muted/30 rounded-full w-24 h-24 flex items-center justify-center mx-auto mb-6"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="32"
          height="32"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="lucide lucide-search-x"
        >
          <path d="m13.5 8.5-5 5" />
          <path d="m8.5 8.5 5 5" />
          <circle cx="11" cy="11" r="8" />
          <path d="m21 21-4.3-4.3" />
        </svg>
      </div>
      <h3 class="text-xl font-semibold text-card-foreground mb-2">
        No tournaments found
      </h3>
      <p class="mb-6">
        {{
          searchTerm
            ? "Try adjusting your search criteria"
            : "Create your first tournament to get started"
        }}
      </p>
      <button (click)="createNewTournament()" class="btn btn-primary">
        Create Tournament
      </button>
    </div>
  </section>

  <app-modal
    [isOpen]="isEditModalOpen()"
    (close)="isEditModalOpen.set(false); editingTournament.set(null)"
    title="Edit Tournament"
  >
    <app-tournament-form
      *ngIf="editingTournament()"
      [tournament]="editingTournament()!"
      (save)="handleSaveTournament($event)"
      (cancel)="isEditModalOpen.set(false); editingTournament.set(null)"
    ></app-tournament-form>
  </app-modal>
</app-dashboard-layout>
